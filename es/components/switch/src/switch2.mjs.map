{"version":3,"file":"switch2.mjs","sources":["../../../../../../packages/components/switch/src/switch.vue"],"sourcesContent":["<template>\n  <div :class=\"switchKls\" :style=\"styles\" @click.prevent=\"handleToggle\">\n    <input\n      :id=\"inputId\"\n      ref=\"input\"\n      :class=\"ns.e('input')\"\n      type=\"checkbox\"\n      role=\"switch\"\n      :aria-checked=\"checked\"\n      :aria-disabled=\"switchDisabled\"\n      :name=\"name\"\n      :true-value=\"activeValue\"\n      :false-value=\"inactiveValue\"\n      :disabled=\"switchDisabled\"\n      :tabindex=\"tabindex\"\n      @change=\"toggleSwitch\"\n      @keydown.enter=\"handleToggle\"\n    />\n    <span\n      v-if=\"!inlinePrompt && (inactiveIcon || inactiveText)\"\n      :class=\"[\n        ns.e('label'),\n        ns.em('label', 'left'),\n        ns.is('active', !checked),\n      ]\"\n    >\n      <el-icon v-if=\"inactiveIcon\"><component :is=\"inactiveIcon\" /></el-icon>\n      <span v-if=\"!inactiveIcon && inactiveText\" :aria-hidden=\"checked\">{{\n        inactiveText\n      }}</span>\n    </span>\n    <span ref=\"core\" :class=\"ns.e('core')\" :style=\"coreStyle\">\n      <div v-if=\"inlinePrompt\" :class=\"ns.e('inner')\">\n        <template v-if=\"activeIcon || inactiveIcon\">\n          <el-icon\n            v-if=\"activeIcon\"\n            :class=\"[ns.is('icon'), checked ? ns.is('show') : ns.is('hide')]\"\n          >\n            <component :is=\"activeIcon\" />\n          </el-icon>\n          <el-icon\n            v-if=\"inactiveIcon\"\n            :class=\"[ns.is('icon'), !checked ? ns.is('show') : ns.is('hide')]\"\n          >\n            <component :is=\"inactiveIcon\" />\n          </el-icon>\n        </template>\n        <template v-else-if=\"activeText || inactiveIcon\">\n          <span\n            v-if=\"activeText\"\n            :class=\"[ns.is('text'), checked ? ns.is('show') : ns.is('hide')]\"\n            :aria-hidden=\"!checked\"\n          >\n            {{ activeText.substring(0, 3) }}\n          </span>\n          <span\n            v-if=\"inactiveText\"\n            :class=\"[ns.is('text'), !checked ? ns.is('show') : ns.is('hide')]\"\n            :aria-hidden=\"checked\"\n          >\n            {{ inactiveText.substring(0, 3) }}\n          </span>\n        </template>\n      </div>\n      <div :class=\"ns.e('action')\">\n        <el-icon v-if=\"loading\" :class=\"ns.is('loading')\"><loading /></el-icon>\n      </div>\n    </span>\n    <span\n      v-if=\"!inlinePrompt && (activeIcon || activeText)\"\n      :class=\"[\n        ns.e('label'),\n        ns.em('label', 'right'),\n        ns.is('active', checked),\n      ]\"\n    >\n      <el-icon v-if=\"activeIcon\"><component :is=\"activeIcon\" /></el-icon>\n      <span v-if=\"!activeIcon && activeText\" :aria-hidden=\"!checked\">{{\n        activeText\n      }}</span>\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { useVModel } from '@vueuse/core'\nimport {\n  addUnit,\n  debugWarn,\n  isBoolean,\n  rAF,\n  throwError,\n} from '@element-plus/utils'\nimport ElIcon from '@element-plus/components/icon'\nimport { Loading } from '@element-plus/icons-vue'\nimport { CHANGE_EVENT } from '@element-plus/constants'\nimport {\n  useDisabled,\n  useFormItem,\n  useFormItemInputId,\n  useNamespace,\n  useSize,\n} from '@element-plus/hooks'\nimport { switchEmits, switchProps } from './switch'\nimport type { CSSProperties } from 'vue'\n\nconst COMPONENT_NAME = 'ElSwitch'\ndefineOptions({\n  name: COMPONENT_NAME,\n})\n\nconst props = defineProps(switchProps)\nconst emit = defineEmits(switchEmits)\n\nconst { formItem } = useFormItem()\nconst switchSize = useSize()\nconst switchDisabled = useDisabled(computed(() => props.loading))\nconst ns = useNamespace('switch')\nconst { inputId } = useFormItemInputId(props, {\n  formItemContext: formItem,\n})\n\nconst value = useVModel(props, 'modelValue', emit)\nconst checked = computed({\n  get: () => value.value === props.activeValue,\n  set: (checked) => {\n    const val = checked ? props.activeValue : props.inactiveValue\n    value.value = val\n    emit(CHANGE_EVENT, val)\n  },\n})\n\nconst input = ref<HTMLInputElement>()\nconst core = ref<HTMLSpanElement>()\n\nconst switchKls = computed(() => [\n  ns.b(),\n  ns.m(switchSize.value),\n  ns.is('disabled', switchDisabled.value),\n  ns.is('checked', checked.value),\n])\n\nconst coreStyle = computed<CSSProperties>(() => ({\n  width: addUnit(props.width),\n}))\n\nconst toggleSwitch = () => {\n  checked.value = !checked.value\n  rAF(() => {\n    input.value!.checked = checked.value\n  })\n}\n\nconst handleToggle = async () => {\n  if (switchDisabled.value) return\n\n  const { beforeChange } = props\n  if (!beforeChange) {\n    toggleSwitch()\n    return\n  }\n\n  let shouldChange: boolean\n  try {\n    shouldChange = await beforeChange()\n  } catch (e) {\n    debugWarn(COMPONENT_NAME, `some error occurred: ${e}`)\n    return\n  }\n\n  if (!isBoolean(shouldChange)) {\n    throwError(\n      COMPONENT_NAME,\n      'beforeChange must return type `Promise<boolean>` or `boolean`'\n    )\n  } else if (!shouldChange) return\n  toggleSwitch()\n}\n\nconst styles = computed(() => {\n  return ns.cssVarBlock({\n    ...(props.activeColor ? { 'on-color': props.activeColor } : null),\n    ...(props.inactiveColor ? { 'off-color': props.inactiveColor } : null),\n    ...(props.borderColor ? { 'border-color': props.borderColor } : null),\n  })\n})\n\nconst focus = (): void => {\n  input.value?.focus?.()\n}\n\nonMounted(() => {\n  input.value!.checked = checked.value\n})\n\nwatch(checked, (val) => {\n  input.value!.checked = val\n\n  if (props.validateEvent) {\n    formItem?.validate('change').catch((err) => debugWarn(err))\n  }\n})\n\nwatch(\n  value,\n  (value) => {\n    if (![props.activeValue, props.inactiveValue].includes(value)) {\n      checked.value = false\n    }\n  },\n  { immediate: true }\n)\n\ndefineExpose({\n  /**\n   *  @description manual focus to the switch component\n   **/\n  focus,\n  /**\n   * @description whether Switch is checked\n   */\n  checked,\n})\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;mCA4Gc,CAAA;AAAA,EACZ,IAAM,EAAA,cAAA;AACR;;;;;;;AAKA,IAAM,MAAA,EAAE,aAAa,WAAY,EAAA,CAAA;AACjC,IAAA,MAAM,aAAa,OAAQ,EAAA,CAAA;AAC3B,IAAA,MAAM,iBAAiB,WAAY,CAAA,QAAA,CAAS,MAAM,KAAA,CAAM,OAAO,CAAC,CAAA,CAAA;AAChE,IAAM,MAAA,EAAA,GAAK,aAAa,QAAQ,CAAA,CAAA;AAChC,IAAM,MAAA,EAAE,OAAY,EAAA,GAAA,kBAAA,CAAmB,KAAO,EAAA;AAAA,MAC5C,eAAiB,EAAA,QAAA;AAAA,KAClB,CAAA,CAAA;AAED,IAAA,MAAM,KAAQ,GAAA,SAAA,CAAU,KAAO,EAAA,YAAA,EAAc,IAAI,CAAA,CAAA;AACjD,IAAA,MAAM,UAAU,QAAS,CAAA;AAAA,MACvB,GAAK,EAAA,MAAM,KAAM,CAAA,KAAA,KAAU,KAAM,CAAA,WAAA;AAAA,MACjC,GAAA,EAAK,CAAC,QAAY,KAAA;AAChB,QAAA,MAAM,GAAM,GAAA,QAAA,GAAU,KAAM,CAAA,WAAA,GAAc,KAAM,CAAA,aAAA,CAAA;AAChD,QAAA,KAAA,CAAM,KAAQ,GAAA,GAAA,CAAA;AACd,QAAA,IAAA,CAAK,cAAc,GAAG,CAAA,CAAA;AAAA,OACxB;AAAA,KACD,CAAA,CAAA;AAED,IAAA,MAAM,QAAQ,GAAsB,EAAA,CAAA;AACpC,IAAA,MAAM,OAAO,GAAqB,EAAA,CAAA;AAElC,IAAM,MAAA,SAAA,GAAY,SAAS,MAAM;AAAA,MAC/B,GAAG,CAAE,EAAA;AAAA,MACL,EAAA,CAAG,CAAE,CAAA,UAAA,CAAW,KAAK,CAAA;AAAA,MACrB,EAAG,CAAA,EAAA,CAAG,UAAY,EAAA,cAAA,CAAe,KAAK,CAAA;AAAA,MACtC,EAAG,CAAA,EAAA,CAAG,SAAW,EAAA,OAAA,CAAQ,KAAK,CAAA;AAAA,KAC/B,CAAA,CAAA;AAED,IAAM,MAAA,SAAA,GAAY,SAAwB,OAAO;AAAA,MAC/C,KAAA,EAAO,OAAQ,CAAA,KAAA,CAAM,KAAK,CAAA;AAAA,KAC1B,CAAA,CAAA,CAAA;AAEF,IAAA,MAAM,eAAe,MAAM;AACzB,MAAQ,OAAA,CAAA,KAAA,GAAQ,CAAC,OAAQ,CAAA,KAAA,CAAA;AACzB,MAAA,GAAA,CAAI,MAAM;AACR,QAAM,KAAA,CAAA,KAAA,CAAO,UAAU,OAAQ,CAAA,KAAA,CAAA;AAAA,OAChC,CAAA,CAAA;AAAA,KACH,CAAA;AAEA,IAAA,MAAM,eAAe,YAAY;AAC/B,MAAA,IAAI,cAAe,CAAA,KAAA;AAAO,QAAA,OAAA;AAE1B,MAAA,MAAM,EAAE,YAAiB,EAAA,GAAA,KAAA,CAAA;AACzB,MAAA,IAAI,CAAC,YAAc,EAAA;AACjB,QAAa,YAAA,EAAA,CAAA;AACb,QAAA,OAAA;AAAA,OACF;AAEA,MAAI,IAAA,YAAA,CAAA;AACJ,MAAI,IAAA;AACF,QAAA,YAAA,GAAe,MAAM,YAAa,EAAA,CAAA;AAAA,eAC3B,CAAP,EAAA;AACA,QAAU,SAAA,CAAA,cAAA,EAAgB,wBAAwB,CAAG,CAAA,CAAA,CAAA,CAAA;AACrD,QAAA,OAAA;AAAA,OACF;AAEA,MAAI,IAAA,CAAC,SAAU,CAAA,YAAY,CAAG,EAAA;AAC5B,QAAA,UAAA,CACE,gBACA,+DACF,CAAA,CAAA;AAAA,iBACS,CAAC,YAAA;AAAc,QAAA,OAAA;AAC1B,MAAa,YAAA,EAAA,CAAA;AAAA,KACf,CAAA;AAEA,IAAM,MAAA,MAAA,GAAS,SAAS,MAAM;AAC5B,MAAA,OAAO,GAAG,WAAY,CAAA;AAAA,QACpB,GAAI,KAAM,CAAA,WAAA,GAAc,EAAE,UAAY,EAAA,KAAA,CAAM,aAAgB,GAAA,IAAA;AAAA,QAC5D,GAAI,KAAM,CAAA,aAAA,GAAgB,EAAE,WAAa,EAAA,KAAA,CAAM,eAAkB,GAAA,IAAA;AAAA,QACjE,GAAI,KAAM,CAAA,WAAA,GAAc,EAAE,cAAgB,EAAA,KAAA,CAAM,aAAgB,GAAA,IAAA;AAAA,OACjE,CAAA,CAAA;AAAA,KACF,CAAA,CAAA;AAED,IAAA,MAAM,QAAQ,MAAY;AACxB,MAAA,IAAA,EAAM;AAAe,MACvB,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,KAAA,CAAA,KAAA,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,KAAA,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AAEA,KAAA,CAAA;AACE,IAAM,SAAA,CAAA;AAAyB,MAChC,KAAA,CAAA,KAAA,CAAA,OAAA,GAAA,OAAA,CAAA,KAAA,CAAA;AAED,KAAM,CAAA,CAAA;AACJ,IAAA,KAAA,CAAA,SAAuB,CAAA,GAAA,KAAA;AAEvB,MAAA,WAAyB,CAAA,OAAA,GAAA,GAAA,CAAA;AACvB,MAAU,IAAA,KAAA,CAAA;AAAgD,QAC5D,QAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,QAAA,CAAA,QAAA,CAAA,QAAA,CAAA,CAAA,KAAA,CAAA,CAAA,GAAA,KAAA,SAAA,CAAA,GAAA,CAAA,CAAA,CAAA;AAAA,OACD;AAED,KACE,CAAA,CAAA;AAEE,IAAI,KAAA,CAAA,KAAQ,EAAA,CAAA,MAAA,KAAA;AACV,MAAA,IAAA,CAAA,CAAA,KAAgB,CAAA,WAAA,EAAA,KAAA,CAAA,aAAA,CAAA,CAAA,QAAA,CAAA,MAAA,CAAA,EAAA;AAAA,QAClB,OAAA,CAAA,KAAA,GAAA,KAAA,CAAA;AAAA,OAEF;AAGF,KAAa,EAAA,EAAA,SAAA,EAAA,IAAA,EAAA,CAAA,CAAA;AAAA,IAIX,MAAA,CAAA;AAAA,MAIA,KAAA;AAAA,MACD,OAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}